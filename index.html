<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resultados Dia de Sorte</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#ffa500',
                        'primary-light': '#ffb833',
                        'primary-dark': '#cc8500',
                        'light-bg': '#fff6e6',
                        'dark-bg': '#1a1100',
                        'orange-50': '#fff6e6',
                        'orange-100': '#ffedcc',
                        'orange-200': '#ffe4b3',
                        'orange-300': '#ffdb99',
                        'orange-400': '#ffd280',
                        'orange-500': '#ffa500',
                        'orange-600': '#e69500',
                        'orange-700': '#cc8500',
                        'orange-800': '#996300',
                        'orange-900': '#664200'
                    }
                }
            }
        }
    </script>
    <style>
        .loading {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        
        .numero-par {
            background-color: #ffe4b3;
            color: #996300;
            border-radius: 6px;
            font-weight: 600;
        }
        
        .numero-impar {
            background-color: #ffd280;
            color: #664200;
            border-radius: 6px;
            font-weight: 600;
        }
        
        .dark .numero-par {
            background-color: #996300;
            color: #ffe4b3;
        }
        
        .dark .numero-impar {
            background-color: #cc8500;
            color: #ffedcc;
        }
        
        .mes-destaque {
            background-color: #ffa500;
            color: white;
            font-weight: bold;
        }
        
        .dark .mes-destaque {
            background-color: #e69500;
            color: white;
        }
        
        .filtro-ativo {
            background-color: #ffa500;
            color: white;
        }
    </style>
</head>
<body class="bg-light-bg dark:bg-dark-bg min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-3xl font-bold text-gray-800 dark:text-white mb-4">
                üçÄ Resultados Dia de Sorte
            </h1>
            <p class="text-gray-600 dark:text-gray-300">
                Resultados oficiais da Caixa Econ√¥mica Federal
            </p>
        </div>

        <!-- Controles -->
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-8">
            <div class="flex flex-col gap-4">
                <div class="flex flex-col sm:flex-row gap-4 items-center justify-between">
                    <div class="flex flex-col sm:flex-row gap-4 items-center">
                        <label class="text-gray-700 dark:text-gray-300 font-medium">
                            Concursos:
                        </label>
                        <input 
                            type="number" 
                            id="concursoInicio" 
                            value="1"
                            placeholder="Concurso inicial"
                            class="px-4 py-2 text-base border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent dark:bg-gray-700 dark:text-white"
                        >
                        <span class="text-gray-500 dark:text-gray-400">at√©</span>
                        <input 
                            type="number" 
                            id="concursoFim" 
                            placeholder="Buscando √∫ltimo..."
                            class="px-4 py-2 text-base border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent dark:bg-gray-700 dark:text-white"
                        >
                    </div>
                    <button 
                        id="buscarBtn" 
                        class="bg-primary hover:bg-primary-dark text-white font-medium py-2 px-6 rounded-lg transition-colors duration-200 disabled:opacity-50"
                    >
                        üîç Carregar Resultados
                    </button>
                </div>
                
                <!-- Op√ß√µes de destacar e ordena√ß√£o -->
                <div class="flex flex-col sm:flex-row gap-4 items-center">
                    <label class="text-gray-700 dark:text-gray-300 font-medium">
                        Destacar:
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" id="destacarPares" class="mr-2" checked>
                        <span class="text-gray-700 dark:text-gray-300">Pares</span>
                        <div class="w-4 h-4 bg-orange-200 ml-2 rounded border"></div>
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" id="destacarImpares" class="mr-2" checked>
                        <span class="text-gray-700 dark:text-gray-300">√çmpares</span>
                        <div class="w-4 h-4 bg-orange-400 ml-2 rounded border"></div>
                    </label>
                    
                    <!-- Divisor -->
                    <div class="hidden sm:block w-px h-6 bg-gray-300 dark:bg-gray-600"></div>
                    
                    <label class="flex items-center">
                        <input type="checkbox" id="ordenarCrescente" class="mr-2">
                        <span class="text-gray-700 dark:text-gray-300">üìä Ordenar dezenas crescente</span>
                    </label>
                </div>
            </div>
        </div>

        <!-- Loading -->
        <div id="loading" class="hidden text-center py-8">
            <div class="loading bg-primary rounded-full w-12 h-12 mx-auto mb-4"></div>
            <p id="loadingText" class="text-gray-600 dark:text-gray-300 mb-4">Carregando resultados...</p>
            
            <!-- Barra de progresso -->
            <div class="max-w-md mx-auto">
                <div class="bg-gray-200 dark:bg-gray-700 rounded-full h-3 mb-2">
                    <div id="progressBar" class="bg-primary h-3 rounded-full transition-all duration-300" style="width: 0%"></div>
                </div>
                <div class="flex justify-between text-xs text-gray-500 dark:text-gray-400">
                    <span id="progressText">0 / 0 concursos</span>
                    <span id="progressPercent">0%</span>
                </div>
            </div>
            
            <!-- Bot√£o cancelar -->
            <button id="cancelarBtn" class="mt-4 px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg text-sm transition-colors">
                ‚ùå Cancelar Carregamento
            </button>
        </div>

        <!-- Erro -->
        <div id="erro" class="hidden bg-red-100 dark:bg-red-900 border border-red-400 text-red-700 dark:text-red-200 px-4 py-3 rounded-lg mb-6">
            <span id="erroMsg"></span>
        </div>

        <!-- Tabela de Resultados -->
        <div id="resultados" class="hidden">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden">
                <div class="bg-gradient-to-r from-primary to-orange-600 text-white p-4">
                    <h2 class="text-xl font-bold text-center">DIA DE SORTE</h2>
                </div>
                
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead class="bg-gray-50 dark:bg-gray-700">
                            <tr>
                                <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    Concurso
                                </th>
                                <th class="px-3 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    Data Sorteio
                                </th>
                                <th class="px-1 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    <div class="flex flex-col items-center">
                                        <span class="text-xs">Bola 1</span>
                                        <input type="text" id="filtro1" placeholder="Filtro" class="mt-1 px-1 py-1 text-xs border rounded w-14">
                                    </div>
                                </th>
                                <th class="px-1 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    <div class="flex flex-col items-center">
                                        <span class="text-xs">Bola 2</span>
                                        <input type="text" id="filtro2" placeholder="Filtro" class="mt-1 px-1 py-1 text-xs border rounded w-14">
                                    </div>
                                </th>
                                <th class="px-1 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    <div class="flex flex-col items-center">
                                        <span class="text-xs">Bola 3</span>
                                        <input type="text" id="filtro3" placeholder="Filtro" class="mt-1 px-1 py-1 text-xs border rounded w-14">
                                    </div>
                                </th>
                                <th class="px-1 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    <div class="flex flex-col items-center">
                                        <span class="text-xs">Bola 4</span>
                                        <input type="text" id="filtro4" placeholder="Filtro" class="mt-1 px-1 py-1 text-xs border rounded w-14">
                                    </div>
                                </th>
                                <th class="px-1 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    <div class="flex flex-col items-center">
                                        <span class="text-xs">Bola 5</span>
                                        <input type="text" id="filtro5" placeholder="Filtro" class="mt-1 px-1 py-1 text-xs border rounded w-14">
                                    </div>
                                </th>
                                <th class="px-1 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    <div class="flex flex-col items-center">
                                        <span class="text-xs">Bola 6</span>
                                        <input type="text" id="filtro6" placeholder="Filtro" class="mt-1 px-1 py-1 text-xs border rounded w-14">
                                    </div>
                                </th>
                                <th class="px-1 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    <div class="flex flex-col items-center">
                                        <span class="text-xs">Bola 7</span>
                                        <input type="text" id="filtro7" placeholder="Filtro" class="mt-1 px-1 py-1 text-xs border rounded w-14">
                                    </div>
                                </th>
                                <th class="px-3 py-3 text-center text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">
                                    M√™s da Sorte
                                </th>
                            </tr>
                        </thead>
                        <tbody id="tabelaBody" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                            <!-- Resultados ser√£o inseridos aqui -->
                        </tbody>
                    </table>
                </div>
                
                <div class="bg-gray-50 dark:bg-gray-700 px-4 py-3">
                    <p class="text-sm text-gray-600 dark:text-gray-300 text-center">
                        üìä Fonte: Caixa Econ√¥mica Federal - API Oficial
                    </p>
                </div>
            </div>
        </div>

        <!-- Informa√ß√µes Adicionais -->
        <div id="infoAdicional" class="hidden mt-8 bg-blue-50 dark:bg-blue-900 border border-blue-200 dark:border-blue-700 rounded-lg p-6">
            <h3 class="text-lg font-semibold text-blue-800 dark:text-blue-200 mb-4">
                üìã Informa√ß√µes do Concurso
            </h3>
            <div id="detalhes" class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-blue-700 dark:text-blue-300">
                <!-- Detalhes ser√£o inseridos aqui -->
            </div>
        </div>
    </div>

    <script>
        // Detectar tema escuro
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });

        // Elementos do DOM
        const concursoInicio = document.getElementById('concursoInicio');
        const concursoFim = document.getElementById('concursoFim');
        const buscarBtn = document.getElementById('buscarBtn');
        const loading = document.getElementById('loading');
        const loadingText = document.getElementById('loadingText');
        const progressBar = document.getElementById('progressBar');
        const progressText = document.getElementById('progressText');
        const progressPercent = document.getElementById('progressPercent');
        const cancelarBtn = document.getElementById('cancelarBtn');
        const erro = document.getElementById('erro');
        const erroMsg = document.getElementById('erroMsg');
        const resultados = document.getElementById('resultados');
        const tabelaBody = document.getElementById('tabelaBody');
        const infoAdicional = document.getElementById('infoAdicional');
        const detalhes = document.getElementById('detalhes');
        const destacarPares = document.getElementById('destacarPares');
        const destacarImpares = document.getElementById('destacarImpares');
        const ordenarCrescente = document.getElementById('ordenarCrescente');

        // Vari√°veis globais
        let todosResultados = [];
        let carregamentoAtivo = false;
        let ultimoConcursoNumero = 0;

        // Fun√ß√£o para formatar data
        function formatarData(dataStr) {
            if (!dataStr) return 'N/A';
            
            try {
                // Tentar diferentes formatos de data
                let data;
                
                // Se j√° √© uma data v√°lida
                if (dataStr instanceof Date) {
                    data = dataStr;
                } else if (typeof dataStr === 'string') {
                    // Tentar formato ISO (2018-02-06)
                    if (dataStr.includes('-')) {
                        data = new Date(dataStr);
                    } 
                    // Tentar formato brasileiro (06/02/2018)
                    else if (dataStr.includes('/')) {
                        const [dia, mes, ano] = dataStr.split('/');
                        data = new Date(ano, mes - 1, dia);
                    } 
                    // Tentar como timestamp
                    else if (!isNaN(dataStr)) {
                        data = new Date(parseInt(dataStr));
                    } 
                    // Tentar parse direto
                    else {
                        data = new Date(dataStr);
                    }
                } else {
                    data = new Date(dataStr);
                }
                
                // Verificar se a data √© v√°lida
                if (data && !isNaN(data.getTime())) {
                    return data.toLocaleDateString('pt-BR');
                } else {
                    return 'N/A';
                }
            } catch (error) {
                console.error('Erro ao formatar data:', dataStr, error);
                return 'N/A';
            }
        }

        // Fun√ß√£o para buscar √∫ltimo concurso
        async function buscarUltimoConcurso() {
            try {
                console.log('Tentando buscar √∫ltimo concurso...');
                const response = await fetch('https://servicebus2.caixa.gov.br/portaldeloterias/api/diadesorte');
                
                if (!response.ok) {
                    throw new Error(`Erro HTTP ${response.status}: ${response.statusText}`);
                }
                
                const data = await response.json();
                console.log('Dados recebidos da API:', data);
                
                if (!data || typeof data.numero === 'undefined') {
                    throw new Error('Resposta da API n√£o cont√©m n√∫mero do concurso');
                }
                
                const ultimoConcurso = data.numero;
                console.log('√öltimo concurso encontrado:', ultimoConcurso);
                return ultimoConcurso;
                
            } catch (error) {
                console.error('Erro detalhado ao buscar √∫ltimo concurso:', error);
                
                // Fallback: tentar estimar baseado na data atual
                // Dia de Sorte come√ßou em 2018, aproximadamente 3 sorteios por semana
                const dataInicio = new Date('2018-05-19'); // Data aproximada do primeiro concurso
                const dataAtual = new Date();
                const diasDecorridos = Math.floor((dataAtual - dataInicio) / (1000 * 60 * 60 * 24));
                const concursoEstimado = Math.floor(diasDecorridos / 2.3); // Aproximadamente 3 por semana
                
                console.log(`Usando fallback: concurso estimado ${concursoEstimado}`);
                return Math.max(concursoEstimado, 1000); // Garantir um n√∫mero m√≠nimo razo√°vel
            }
        }

        // Fun√ß√£o para atualizar progresso
        function atualizarProgresso(atual, total) {
            const porcentagem = Math.round((atual / total) * 100);
            progressBar.style.width = `${porcentagem}%`;
            progressText.textContent = `${atual} / ${total} concursos`;
            progressPercent.textContent = `${porcentagem}%`;
        }

        // Fun√ß√£o para cancelar carregamento
        function cancelarCarregamento() {
            carregamentoAtivo = false;
            loading.classList.add('hidden');
            buscarBtn.disabled = false;
            loadingText.textContent = 'Carregamento cancelado';
        }

        // Fun√ß√£o para buscar resultados de m√∫ltiplos concursos
        async function buscarResultados() {
            const inicio = parseInt(concursoInicio.value) || 1;
            let fim = parseInt(concursoFim.value);

            // Mostrar loading
            loading.classList.remove('hidden');
            resultados.classList.add('hidden');
            erro.classList.add('hidden');
            infoAdicional.classList.add('hidden');
            buscarBtn.disabled = true;
            carregamentoAtivo = true;

            try {
                // Se n√£o especificou fim, buscar √∫ltimo concurso
                if (!fim) {
                    loadingText.textContent = 'Buscando √∫ltimo concurso...';
                    fim = await buscarUltimoConcurso();
                    if (!fim) throw new Error('N√£o foi poss√≠vel determinar o √∫ltimo concurso');
                    ultimoConcursoNumero = fim;
                }

                // Valida√ß√µes
                if (inicio > fim) {
                    throw new Error('Concurso inicial n√£o pode ser maior que o final');
                }

                const totalConcursos = fim - inicio + 1;
                const tamanhoBatch = 20; // Aumentei para 20 por lote
                let concursosCarregados = 0;

                loadingText.textContent = `Carregando ${totalConcursos} concursos em lotes...`;
                atualizarProgresso(0, totalConcursos);

                todosResultados = [];

                // Carregar em lotes
                for (let i = inicio; i <= fim && carregamentoAtivo; i += tamanhoBatch) {
                    const fimBatch = Math.min(i + tamanhoBatch - 1, fim);
                    
                    // Criar promises para o lote atual
                    const promisesBatch = [];
                    for (let j = i; j <= fimBatch; j++) {
                        promisesBatch.push(buscarConcurso(j));
                    }

                    // Executar lote em paralelo
                    const resultadosBatch = await Promise.allSettled(promisesBatch);
                    
                    // Processar resultados do lote
                    resultadosBatch.forEach((resultado, index) => {
                        if (resultado.status === 'fulfilled' && resultado.value) {
                            todosResultados.push(resultado.value);
                        }
                        concursosCarregados++;
                        
                        // Atualizar progresso
                        atualizarProgresso(concursosCarregados, totalConcursos);
                    });

                    // Atualizar interface a cada lote
                    if (todosResultados.length > 0) {
                        // Ordenar e exibir resultados parciais
                        todosResultados.sort((a, b) => a.numero - b.numero);
                        exibirTodosResultados();
                    }

                    // Pequena pausa para n√£o sobrecarregar
                    await new Promise(resolve => setTimeout(resolve, 100));
                }

                if (!carregamentoAtivo) {
                    throw new Error('Carregamento cancelado pelo usu√°rio');
                }

                // Ordenar final
                todosResultados.sort((a, b) => a.numero - b.numero);

                if (todosResultados.length === 0) {
                    throw new Error('Nenhum resultado encontrado');
                }

                loadingText.textContent = `‚úÖ Carregados ${todosResultados.length} concursos com sucesso!`;
                exibirTodosResultados();
                
            } catch (error) {
                console.error('Erro ao buscar resultados:', error);
                erroMsg.textContent = error.message;
                erro.classList.remove('hidden');
            } finally {
                loading.classList.add('hidden');
                buscarBtn.disabled = false;
                carregamentoAtivo = false;
            }
        }

        // Fun√ß√£o para carregar TODOS os concursos automaticamente
        async function carregarTodosOsConcursos() {
            loadingText.textContent = 'Iniciando carregamento de TODOS os concursos...';
            
            try {
                // Buscar √∫ltimo concurso
                const ultimoConcurso = await buscarUltimoConcurso();
                if (!ultimoConcurso) {
                    throw new Error('N√£o foi poss√≠vel determinar o √∫ltimo concurso');
                }

                ultimoConcursoNumero = ultimoConcurso;
                
                // Definir do primeiro ao √∫ltimo
                concursoInicio.value = 1;
                concursoFim.value = ultimoConcurso;
                
                // Iniciar carregamento
                await buscarResultados();
                
            } catch (error) {
                console.error('Erro ao carregar todos os concursos:', error);
                erroMsg.textContent = `Erro ao carregar todos os concursos: ${error.message}`;
                erro.classList.remove('hidden');
                loading.classList.add('hidden');
            }
        }

        // Fun√ß√£o para buscar um concurso espec√≠fico
        async function buscarConcurso(numero) {
            try {
                const response = await fetch(`https://servicebus2.caixa.gov.br/portaldeloterias/api/diadesorte/${numero}`);
                if (!response.ok) return null;
                const data = await response.json();
                return data;
            } catch (error) {
                console.error(`Erro ao buscar concurso ${numero}:`, error);
                return null;
            }
        }

        // Fun√ß√£o para criar c√©lula de n√∫mero com destaque par/√≠mpar
        function criarCelulaNumero(numero) {
            const cellNumero = document.createElement('td');
            cellNumero.className = 'px-2 py-4 whitespace-nowrap text-center text-sm font-medium text-gray-900 dark:text-white';
            cellNumero.textContent = numero;
            cellNumero.dataset.numero = numero;

            // Aplicar cores baseado em par/√≠mpar
            aplicarDestaque(cellNumero, numero);

            return cellNumero;
        }

        // Fun√ß√£o para aplicar destaque par/√≠mpar
        function aplicarDestaque(elemento, numero) {
            elemento.classList.remove('numero-par', 'numero-impar');
            
            if (destacarPares.checked && numero % 2 === 0) {
                elemento.classList.add('numero-par');
            } else if (destacarImpares.checked && numero % 2 === 1) {
                elemento.classList.add('numero-impar');
            }
        }

        // Fun√ß√£o para exibir todos os resultados na tabela
        function exibirTodosResultados() {
            tabelaBody.innerHTML = '';

            todosResultados.forEach(data => {
                const row = document.createElement('tr');
                row.className = 'hover:bg-gray-50 dark:hover:bg-gray-700';
                row.dataset.concurso = data.numero;

                // N√∫mero do concurso
                const cellConcurso = document.createElement('td');
                cellConcurso.className = 'px-3 py-4 whitespace-nowrap text-sm font-medium text-gray-900 dark:text-white';
                cellConcurso.textContent = data.numero;
                row.appendChild(cellConcurso);

                // Data do sorteio
                const cellData = document.createElement('td');
                cellData.className = 'px-3 py-4 whitespace-nowrap text-sm text-gray-700 dark:text-gray-300';
                
                // Tentar diferentes campos de data se dataApuracao n√£o estiver dispon√≠vel
                const dataFormatada = formatarData(data.dataApuracao) || 
                                    formatarData(data.dataSorteio) || 
                                    formatarData(data.data) || 
                                    'N/A';
                                    
                cellData.textContent = dataFormatada;
                row.appendChild(cellData);

                // Dezenas sorteadas
                if (data.dezenasSorteadasOrdemSorteio) {
                    // Decidir se ordena ou mant√©m ordem original
                    let numerosExibir = [...data.dezenasSorteadasOrdemSorteio];
                    if (ordenarCrescente.checked) {
                        numerosExibir.sort((a, b) => a - b);
                    }
                    
                    numerosExibir.forEach((numero, index) => {
                        const cellNumero = criarCelulaNumero(numero);
                        cellNumero.dataset.coluna = index + 1;
                        cellNumero.dataset.numeroOriginal = data.dezenasSorteadasOrdemSorteio[index];
                        row.appendChild(cellNumero);
                    });
                }

                // M√™s da Sorte (usando nomeTimeCoracaoMesSorte)
                const cellMes = document.createElement('td');
                cellMes.className = 'px-3 py-4 whitespace-nowrap text-center';
                
                const spanMes = document.createElement('span');
                spanMes.className = 'inline-flex items-center px-3 py-1 text-sm font-bold rounded-full mes-destaque';
                spanMes.textContent = data.nomeTimeCoracaoMesSorte || 'N/A';
                
                cellMes.appendChild(spanMes);
                row.appendChild(cellMes);

                tabelaBody.appendChild(row);
            });

            resultados.classList.remove('hidden');
            
            // Aplicar filtros existentes
            aplicarFiltros();
        }

        // Fun√ß√£o para aplicar filtros
        function aplicarFiltros() {
            const filtros = [];
            for (let i = 1; i <= 7; i++) {
                const filtro = document.getElementById(`filtro${i}`).value.trim();
                filtros.push(filtro);
            }

            const rows = tabelaBody.querySelectorAll('tr');
            
            rows.forEach(row => {
                let mostrar = true;
                
                // Verificar filtros das colunas
                filtros.forEach((filtro, index) => {
                    if (filtro) {
                        const celula = row.querySelector(`td[data-coluna="${index + 1}"]`);
                        if (celula) {
                            const numero = celula.textContent;
                            if (!numero.includes(filtro)) {
                                mostrar = false;
                            }
                        }
                    }
                });

                row.style.display = mostrar ? '' : 'none';
            });
        }

        // Fun√ß√£o para atualizar destaques
        function atualizarDestaques() {
            const numeros = document.querySelectorAll('td[data-numero]');
            numeros.forEach(elemento => {
                const numero = parseInt(elemento.dataset.numero);
                aplicarDestaque(elemento, numero);
            });
        }

        // Event listeners
        buscarBtn.addEventListener('click', buscarResultados);
        cancelarBtn.addEventListener('click', cancelarCarregamento);
        
        // Event listeners para filtros
        for (let i = 1; i <= 7; i++) {
            const filtro = document.getElementById(`filtro${i}`);
            filtro.addEventListener('input', aplicarFiltros);
        }

        // Event listeners para checkboxes de destaque
        destacarPares.addEventListener('change', atualizarDestaques);
        destacarImpares.addEventListener('change', atualizarDestaques);
        
        // Event listener para ordena√ß√£o crescente
        ordenarCrescente.addEventListener('change', () => {
            if (todosResultados.length > 0) {
                exibirTodosResultados();
            }
        });

        // Enter nos campos de concurso
        concursoInicio.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') buscarResultados();
        });
        
        concursoFim.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') buscarResultados();
        });

        // üöÄ CARREGAR TODOS OS CONCURSOS AUTOMATICAMENTE AO ABRIR A APP
        document.addEventListener('DOMContentLoaded', async () => {
            carregarTodosOsConcursos();
        });
    </script>
</body>
</html>